package apis

import (
	"reflect"
	"testing"

	"github.com/cloudflare/cfssl/certinfo"
	corev1 "k8s.io/api/core/v1"
)

func Test_parseCertsInfo(t *testing.T) {
	type args struct {
		secret corev1.Secret
	}
	tests := []struct {
		name string
		args args
		want map[string]certinfo.Certificate
	}{
		{
			name: "Normal parseCertInfo",
			args: args{
				secret: corev1.Secret{
					Type: corev1.SecretTypeTLS,
					Data: map[string][]byte{
						corev1.TLSCertKey:              []byte("LS0tLS1CRUdJTiBSU0EgUFJJVkFURSBLRVktLS0tLQpNSUlFcEFJQkFBS0NBUUVBcE05V1lPUVdOTUZ6ZWFQLzh0RmpFczdPV0NMSTRHNGF4M3c3aUpTSGpBQVRHNUFzCnZndWJ6N1hPVEhmNlBRMTl2MGpJaEpTUUl3cE9vWXgya0JpYWNHbFBXcHFQcUtDSnlVL2o0S1ZJT1QyWHZONEkKdUNjYVFjZ2hRSmtTSjE2c0FzMzB4OWpsdjk5bDRJTGtqUjlnQ3BuTm5HcGZMWUxlUlNFTzVtMmhHRHhFbmpsUwpodGJCcGl5SUxzejBpb2pWcmdzaEIvcGgrVHJ3eDRnb2RsemRSMHlxWi9zZ0U0aGtjcWJFOHQ0VnhjWHdMaGZICjQ4NmY2cUZpZlNHR295dnp0M1ErVm4rSXpsUENTR1hqWlExdlorRmxkVlhreTF6UUZ3RFFHL28wQk9JN3BvTjgKVm9ma2U1VnZjdExyM0xSV3grblhoMmI5L2VaZVBlQlg4ZjdsOVFJREFRQUJBb0lCQUN6TzJqTTVqL2dENkh0WAo1VXlGTlNSMTZZLzQxUmgvbHZSSmlINFhzOHFTY3A5NTBWQlNJNmlUUzJWcThUUU1LUFlLdWNtaUFwWWtSVUNTCnllRmZidzNFOC9nME1YNnROd2p1bVl3SUk5eThMRGNEUHVlaWFmY2NqRDNkNEJ1b0Y2Z2ppcnVTOHRQNXp0NzkKZDFvTy83T2lJVTYzZE8wUXVaR2Q3VWtrNFRtUEtWZXdMK2o5Smw5MGZOSkY3S3BJeTNsWjJ3QndQdjZHVlFjUQpYQ3g0MUVWTk4vaFd3eUVEMEZNK20wcUdXWjRnN0gyOHdYekszSm52NXh2Y1pwcmJkTi9uSjdBblkrY2VpMytlCnF3ZWxPQ0FraUg2ZmJEaXNQZzQ4ZnRML1RERTZCZ1hjRmJ3bEExS3cwbzU4NWRpNXhJZDh1ZUZQVmMvcWxsTlUKMTIwYkV3RUNnWUVBMkpCQmVJanlxMHZVNmxLWGVBdEZaRjl5Wnk0ZjZZUklKQzEwQkdNT0dtaDc4OEtDZzNjSQo5N0E5Mncwa3pxS0xyRVFmNjRzVU92b1lzcFM4TkY5RlRsRFFkSXRTMW5ybnNJbnlqWlVMRnBZRTVmQzFxMVhRClpxTlFEZVJyZWxCK3FhTXFYUkxYYWxEMWlVeU9pZHVBVStoZmRqNHFrL3lXQS8rYUFNb1AxQlVDZ1lFQXd0SnYKbis0aEE4Q3ZGUHdKWFZocjU2b1Ixc0VRMzc5L0piZTk4bWpPL3FwL0I4V0hZNklQRFVJQ0xhcThhRzlBcWc2cwpjVWxaa092ZklyeDNqN1lYeVdwQ2poQkVTWVdrL0FTWEdkYU9vbXRUVHVIQjFRN0pGdm5DanlJdFMvVk1WYVIrCkRXcXNCK3VpcXh2bTBTRFlqdmVMZ29EU0czUlZsQ3lXQXYzeDRtRUNnWUVBa0hHbk9YNGVYYUoyb05QMXMxdlIKTE9GOHJOVlc4Nm9IZEJuZENCQUptQk9ZbVQxalQ4eFZidDllWW55aDBERWFlQXY0UG1MRlc1RDBhQ2hNWDZJcgoxOUNQT1N5MFU5b21MdG5Ucmh0N0NkV0Y3dGhlVTZrcEYweFdXTzNCd2hOdWFEY3NTbWdHeGlLNW9wb3RlRVd2CmtrZXJaSEtTYzZKRmJPVlBFcmV6VndFQ2dZQkkyaDVKeE9kdG10RWQzTDIzdlVma2duRlhTQzBDTG43aVlOcFQKMnFPRkVjYWM1bDJoZ1VsMW9MaGwwVkhSRDhFemxuY2ZpZGxIV3h5K3haRkVHVWk5MWRGN2hGTzAxcGdDY2NqNwpMWU42OHYxZEl3aXpubXJOLzZta2twZ3pyay9VT3NXMFNLNTU2OENSa2NaM2IzdnJ3bC9WOWt3YlhoNWVZV25iClJwRDhJUUtCZ1FDU1lNakF6WXBVT0RFTmNYNktnT1dXb21NU1p4N1JWMXZJOFkzUWF5UE5KZmUvNGEycW42TSsKMWdWcS8wUk9YSytTQzBDSDV3cjZ2RUpoTmhIQjUxL2cvR3lmdWRpaHFqb09aVHN0aFhxRGJWQ2c0YzNZb1h2YQpJR250L0N6WU14N0lhYjlTWkl4V0k0R0VYaW1TR0ZWYzBDTTNEd3J1ZXJBYTVzYXRBSmlIR1E9PQotLS0tLUVORCBSU0EgUFJJVkFURSBLRVktLS0tLQo="),
						corev1.ServiceAccountRootCAKey: []byte("LS0tLS1CRUdJTiBDRVJUSUZJQ0FURS0tLS0tCk1JSUM5akNDQWQ2Z0F3SUJBZ0lRR3BMSHNUVmtUczk1emFjTy9zNlkyekFOQmdrcWhraUc5dzBCQVFzRkFEQUEKTUI0WERUSXhNRGN4T1RBME1USXdOMW9YRFRJeE1UQXhOekEwTVRJd04xb3dBRENDQVNJd0RRWUpLb1pJaHZjTgpBUUVCQlFBRGdnRVBBRENDQVFvQ2dnRUJBS1RQVm1Ea0ZqVEJjM21qLy9MUll4TE96bGdpeU9CdUdzZDhPNGlVCmg0d0FFeHVRTEw0TG04KzF6a3gzK2owTmZiOUl5SVNVa0NNS1RxR01kcEFZbW5CcFQxcWFqNmlnaWNsUDQrQ2wKU0RrOWw3emVDTGduR2tISUlVQ1pFaWRlckFMTjlNZlk1Yi9mWmVDQzVJMGZZQXFaelp4cVh5MkMza1VoRHVadApvUmc4Uko0NVVvYld3YVlzaUM3TTlJcUkxYTRMSVFmNllmazY4TWVJS0haYzNVZE1xbWY3SUJPSVpIS214UExlCkZjWEY4QzRYeCtQT24rcWhZbjBoaHFNcjg3ZDBQbFovaU01VHdraGw0MlVOYjJmaFpYVlY1TXRjMEJjQTBCdjYKTkFUaU82YURmRmFINUh1VmIzTFM2OXkwVnNmcDE0ZG0vZjNtWGozZ1YvSCs1ZlVDQXdFQUFhTnNNR293RGdZRApWUjBQQVFIL0JBUURBZ1dnTUF3R0ExVWRFd0VCL3dRQ01BQXdTZ1lEVlIwUkFRSC9CRUF3UG9JV2MyVnNabk5wCloyNWxaQzVrWldaaGRXeDBMbk4yWTRJa2MyVnNabk5wWjI1bFpDNWtaV1poZFd4MExuTjJZeTVqYkhWemRHVnkKTG14dlkyRnNNQTBHQ1NxR1NJYjNEUUVCQ3dVQUE0SUJBUUFYVGlOUUZHd3JBSytNektlTkllVSsvL1hFS0dicwozWFdoSU5vbFlvVGFuVFhlQTZKVTdONUoxMWZtL2ExSzZDRHZVd1JxdGNaRk14OGFzR2toNEZQL1hMTElDZWxmCkZFVG9IZWpDYW40M1VUVWx0VW9oZEt3NUhUam9ycWo3bzJ2SndFd0tIdW0za1I3NXZQRjJsYzdiLzNTOTRmU3cKWXc4aWdLWGFaTktIRHFGYlNKSDZHOW9XM20wSUtLR013ZnJBR3JsWm5ML3NQNkxKL3pHOFRoSmg0eWZqNXFmRwpJWkd0TzNxUVVrS3kvalJuQk14cW1ZSkkxU3Y3dGR4aDJQZC9qUHgrR0N1NjVJSnFyUDdGV2t5OHdDSGJHUFVXCi9MSnp5Y0NjZmVWZXBlTmNxcHdnSE14TkYzeFUzN3ZuamxmSG42NFZNZEs1dkVUc2U5MmVXNW1YCi0tLS0tRU5EIENFUlRJRklDQVRFLS0tLS0K"),
						corev1.TLSPrivateKeyKey:        []byte("LS0tLS1CRUdJTiBDRVJUSUZJQ0FURS0tLS0tCk1JSUM5akNDQWQ2Z0F3SUJBZ0lRR3BMSHNUVmtUczk1emFjTy9zNlkyekFOQmdrcWhraUc5dzBCQVFzRkFEQUEKTUI0WERUSXhNRGN4T1RBME1USXdOMW9YRFRJeE1UQXhOekEwTVRJd04xb3dBRENDQVNJd0RRWUpLb1pJaHZjTgpBUUVCQlFBRGdnRVBBRENDQVFvQ2dnRUJBS1RQVm1Ea0ZqVEJjM21qLy9MUll4TE96bGdpeU9CdUdzZDhPNGlVCmg0d0FFeHVRTEw0TG04KzF6a3gzK2owTmZiOUl5SVNVa0NNS1RxR01kcEFZbW5CcFQxcWFqNmlnaWNsUDQrQ2wKU0RrOWw3emVDTGduR2tISUlVQ1pFaWRlckFMTjlNZlk1Yi9mWmVDQzVJMGZZQXFaelp4cVh5MkMza1VoRHVadApvUmc4Uko0NVVvYld3YVlzaUM3TTlJcUkxYTRMSVFmNllmazY4TWVJS0haYzNVZE1xbWY3SUJPSVpIS214UExlCkZjWEY4QzRYeCtQT24rcWhZbjBoaHFNcjg3ZDBQbFovaU01VHdraGw0MlVOYjJmaFpYVlY1TXRjMEJjQTBCdjYKTkFUaU82YURmRmFINUh1VmIzTFM2OXkwVnNmcDE0ZG0vZjNtWGozZ1YvSCs1ZlVDQXdFQUFhTnNNR293RGdZRApWUjBQQVFIL0JBUURBZ1dnTUF3R0ExVWRFd0VCL3dRQ01BQXdTZ1lEVlIwUkFRSC9CRUF3UG9JV2MyVnNabk5wCloyNWxaQzVrWldaaGRXeDBMbk4yWTRJa2MyVnNabk5wWjI1bFpDNWtaV1poZFd4MExuTjJZeTVqYkhWemRHVnkKTG14dlkyRnNNQTBHQ1NxR1NJYjNEUUVCQ3dVQUE0SUJBUUFYVGlOUUZHd3JBSytNektlTkllVSsvL1hFS0dicwozWFdoSU5vbFlvVGFuVFhlQTZKVTdONUoxMWZtL2ExSzZDRHZVd1JxdGNaRk14OGFzR2toNEZQL1hMTElDZWxmCkZFVG9IZWpDYW40M1VUVWx0VW9oZEt3NUhUam9ycWo3bzJ2SndFd0tIdW0za1I3NXZQRjJsYzdiLzNTOTRmU3cKWXc4aWdLWGFaTktIRHFGYlNKSDZHOW9XM20wSUtLR013ZnJBR3JsWm5ML3NQNkxKL3pHOFRoSmg0eWZqNXFmRwpJWkd0TzNxUVVrS3kvalJuQk14cW1ZSkkxU3Y3dGR4aDJQZC9qUHgrR0N1NjVJSnFyUDdGV2t5OHdDSGJHUFVXCi9MSnp5Y0NjZmVWZXBlTmNxcHdnSE14TkYzeFUzN3ZuamxmSG42NFZNZEs1dkVUc2U5MmVXNW1YCi0tLS0tRU5EIENFUlRJRklDQVRFLS0tLS0K"),
					},
				},
			},
			want: map[string]certinfo.Certificate{},
		},
	}
	for _, tt := range tests {
		t.Run(tt.name, func(t *testing.T) {
			if got := parseCertsInfo(tt.args.secret); !reflect.DeepEqual(got, tt.want) {
				t.Errorf("parseCertsInfo() = %v, want %v", got, tt.want)
			}
		})
	}
}
